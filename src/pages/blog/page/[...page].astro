---
import { getCollection } from "astro:content";
import BlogList from "../../../layouts/blog/BlogList.astro";
import { POSTS_PER_PAGE } from "../../../consts";

export async function getStaticPaths({ paginate }: { paginate: Function }) {
  const posts = (await getCollection("blog")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
  );
  return paginate(posts, { pageSize: POSTS_PER_PAGE });
}

const { page } = Astro.props;

if (page.currentPage === 1) {
  return Astro.redirect("/blog/");
}
---

<BlogList posts={page.data} page={page} />
